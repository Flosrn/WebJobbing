{"version":3,"sources":["../../src/pages/edit-offer/edit-offer.module.ts","../../src/pages/edit-offer/edit-offer.ts"],"names":[],"mappings":"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","file":"16.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { IonicPageModule } from 'ionic-angular';\nimport { EditOfferPage } from './edit-offer';\n\n@NgModule({\n  declarations: [\n    EditOfferPage,\n  ],\n  imports: [\n    IonicPageModule.forChild(EditOfferPage),\n  ],\n})\nexport class EditOfferPageModule {}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-offer/edit-offer.module.ts","import { Component, ViewChild, Output, EventEmitter } from '@angular/core';\nimport { ViewController, IonicPage, NavParams, Slides, ModalController, NavController } from 'ionic-angular';\nimport { Observable } from 'rxjs/Observable';\nimport { Profile } from '../../models/profile/profile.interface';\nimport { DataService } from './../../providers/data/data.service';\nimport { PhotoViewer } from '@ionic-native/photo-viewer';\nimport { AuthService } from '../../providers/auth/auth.service';\nimport { User } from \"firebase/app\";\nimport { ToastService2 } from '../../providers/toast/toast.services';\nimport { RequestModalPage } from '../request-modal/request-modal';\nimport { Offer } from '../../models/offer/offer.model';\nimport { OfferListService } from '../../providers/offer/offer-list.services';\nimport { RequestListService } from '../../providers/request/request-list.services';\nimport { Subscription } from 'rxjs/Subscription';\n\n@IonicPage()\n@Component({\n  selector: 'page-edit-offer',\n  templateUrl: 'edit-offer.html',\n})\nexport class EditOfferPage {\n\n  requestList$ = [];\n  profileList$: Observable<Profile[]>;\n  \n  \n  private authenticatedUser$: Subscription;\n  private authenticatedUser: User;\n  \n  request: any;\n  \n  offer: Offer = {\n    uidProfile: '',\n    uidRequest: '',\n    price: undefined,\n    comment: '',\n  }\n  \n  public userProfile: Profile;\n  @Output() existingProfile: EventEmitter<Profile>;\n  \n  constructor(\n    public viewCtrl: ViewController,\n    public navParams: NavParams,\n    public navCtrl: NavController,\n    private data: DataService,\n    public modalCtrl: ModalController,\n    private photoViewer: PhotoViewer,\n    private auth: AuthService, \n    private toast: ToastService2,\n    private offerList: OfferListService,\n    private requests: RequestListService,\n  ) {\n\n    this.authenticatedUser$ = this.auth.getAuthenticatedUser().subscribe((user: User) => {\n      this.authenticatedUser = user;\n    }) \n\n    this.existingProfile = new EventEmitter<Profile>();\n    \n    // Récupère les données transmit par la request\n    this.offer = this.navParams.get('offer');\n\n\n    // this.profileList$ = this.data.getProfileList().snapshotChanges().map(\n    //   changes => {\n    //     return changes.map(c => ({\n    //       key: c.payload.key, ...c.payload.val()\n    //     }));\n    //   });\n\n      // // Récupère la liste des requests\n      // this.requests.getRequestListRef().once('value').then(snap => {\n      //   snap.forEach(element => {\n      //     data.getUid(element.val().uidProfile).valueChanges().subscribe(c => {\n      //       let userRequest = element.val();  \n      //       userRequest['userRequest'] = c;\n\n      //       this.requestList$.push(userRequest);\n      //     });\n      //   });\n      // });\n    }  \n    \n    // Récupère les données de l'utilisateur\n    ngOnInit(): void {  \n      this.auth.getAuthenticatedUser().subscribe((user: User) => {\n        this.data.getProfile(user).valueChanges().subscribe((profile: Profile) => {\n          this.userProfile = <Profile>profile;\n          this.userProfile.uid = user.uid;\n          console.log('Utilisateur connecté :',this.userProfile); \n          this.existingProfile.emit(this.userProfile);\n        })\n      })\n    }\n    \n    // Ajoute l'offre, message toast, redirige\n    saveOffer(offer: Offer) {\n      this.offer.uidProfile = this.userProfile.uid;\n      this.offer.uidRequest = this.request.uidRequest;\n      this.offerList.updateOffer(this.offer).then(ref => {\n\n\n        this.toast.show(`Offre d'un montant de ${offer.price}€ modifiée !`);\n        this.navCtrl.pop();\n      })  \n    }\n    \n    \n    back() { \n      this.viewCtrl.dismiss();\n    }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/edit-offer/edit-offer.ts"],"sourceRoot":""}